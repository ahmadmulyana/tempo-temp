function BeaconTempo(par) { this.par = par; var url = document.location.href; this.send = function() { var c = new CallCookie(); var sid = c.getCookie('btempo_sid_'); var dateObj = new Date(Date.now()); var tzoffset = (new Date()).getTimezoneOffset() * 60000; var localISOTime = (new Date(Date.now() - tzoffset)).toISOString().slice(0, -1); if (sid == '') { c.setCookie('btempo_sid_', Date.now()+Math.floor((Math.random() * 1000) + 1), 24); } $.get('https://www.cloudflare.com/cdn-cgi/trace', function(data) { var dataIp = data.replace(/\n/g, '').split("="); var ipAddress = dataIp[3].replace("ts", ''); $.post("https://analytics.tempo.co/beacon/get.php", { 'date': localISOTime, 'session_id': c.getCookie('btempo_sid_'), 'par': par, 'ip' : ipAddress, 'url': url }, function(data, status){ }); }) } } function CallCookie() { this.setCookie = function (cname, cvalue, exdays) { var d = new Date(); d.setTime(d.getTime() + (exdays*60*60*1000)); var expires = "expires="+ d.toUTCString(); var baseDomain = 'tempo.com'; document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/;domain=.tempo.co;SameSite=None;Secure"; }; this.getCookie = function(cname) { var name = cname + "="; var decodedCookie = decodeURIComponent(document.cookie); var ca = decodedCookie.split(';'); for(var i = 0; i <ca.length; i++) { var c = ca[i]; while (c.charAt(0) == ' ') { c = c.substring(1); } if (c.indexOf(name) == 0) { return c.substring(name.length, c.length); } } return ""; } }
